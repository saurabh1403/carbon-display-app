<?xml version="1.0" encoding="utf-8"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
					   xmlns:s="library://ns.adobe.com/flex/spark" 
					   xmlns:mx="library://ns.adobe.com/flex/mx"
					   creationComplete="windowedapplication1_creationCompleteHandler(event)
					   ">
	<fx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.events.FlexEvent;
			import mx.flash.*;
			
			public var process:NativeProcess;
			
			protected function windowedapplication1_creationCompleteHandler(event:FlexEvent):void
			{
				
			}

			public function  onOutputData(event:ProgressEvent): void
			{ 
				var stdOut:IDataInput = process.standardOutput; 
				var data:String = stdOut.readUTFBytes(process.standardOutput.bytesAvailable);
				outText.text = data;
				retLen.text = data.length.toString();
			}

			protected function button1_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				var len:int = inText.text.length;
				process.standardInput.endian = Endian.LITTLE_ENDIAN;
//				process.standardInput.writeUnsignedInt(len);

//				sendLen.text  = process.standardInput.endian;

				sendLen.text = inText.text.length.toString();
				process.standardInput.writeUTF(inText.text);
//				process.standardInput.writeUTFBytes("hello world\n");
//				process.closeInput();
			}
			

			protected function button2_clickHandler(event:MouseEvent):void
			{
				if(!NativeProcess.isSupported)
				{
					Alert.show(" not supported", "native p ");
				}
				else
				{
					//					Alert.show("supported", "native p ");
					var nativeProcessStartupInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo(); 
					var file:File = File.applicationDirectory.resolvePath("D:\\saurabhg\\projects_related\\flex projects\\flex-native communication\\native process - cpp\\hello\\Debug\\hello.exe"); 
					nativeProcessStartupInfo.executable = file; 
					var processArgs:Vector.<String> = new Vector.<String>(); 
					processArgs.push("hello");
					nativeProcessStartupInfo.arguments = processArgs; 
					process = new NativeProcess();
					process.addEventListener(ProgressEvent.STANDARD_OUTPUT_DATA, onOutputData);
					//					process.addEventListener(ProgressEvent.STANDARD_INPUT_PROGRESS, oninputData); 
					process.start(nativeProcessStartupInfo);
				}			
			}

		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	<s:Button x="93" y="115" label="Send Data" width="125" height="34" enabled="true" click="button1_clickHandler(event)"/>
	<s:TextArea x="35" y="254" width="231" height="33" id="outText"/>
	<s:TextArea x="35" y="174" width="231" height="32" id="inText"/>
	<s:Label x="319" y="174" text="Input text" width="56" height="32" verticalAlign="middle" textAlign="center"/>
	<s:Label x="301" y="258" text="returned&#xd;text" width="111" height="29" verticalAlign="top" textAlign="center"/>
	<s:Label x="110" y="214" text="In text length :" width="97" height="19" id="sendLen"/>
	<s:Label x="110" y="305" text="Label" width="97" height="19" id="retLen"/>
	<s:Button x="93" y="352" label="Launch process" width="139" height="26" click="button2_clickHandler(event)"/>
</s:WindowedApplication>
